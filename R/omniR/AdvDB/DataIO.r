#---------------------------------------------------------------------------------------------------------------------------------------#
#100.   Introduction.                                                                                                                   #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   |This Class is intended to unify the APIs to <pull> data from harddisk to RAM and <push> the data frames onto harddisk              #
#---------------------------------------------------------------------------------------------------------------------------------------#
#200.   Methods                                                                                                                         #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   |100.   Public method                                                                                                               #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[initialize]                                                                                                                   #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to instantiate the container of data input-output methods                                      #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |apiPkgPull        :   <str     > Name of the package from which to obtain the API function to pull the data                #
#   |   |   |                      [NULL                ]<Default> Obtain the API from current session in global environment            #
#   |   |   |                      [<str>               ]          Package name valid for function <AdvOp$importByStr>                  #
#   |   |   |apiPfxPull        :   <str     > Prefix of the puller API name to search                                                   #
#   |   |   |                      [std_read_           ]<Default> Search for the API names by this prefix                              #
#   |   |   |                      [<str>               ]          Set a proper prefix to validate the search                           #
#   |   |   |apiSfxPull        :   <str     > Suffix of the puller API name to search                                                   #
#   |   |   |                      [<empty>             ]<Default> No specific suffix, be careful to use this setting                   #
#   |   |   |                      [<str>               ]          Set a proper suffix to validate the search                           #
#   |   |   |apiPullHdl        :   list[api:<function>] Dict of functions bound to APIs, each with only one argument as handler to      #
#   |   |   |                       process the data pulled at once                                                                     #
#   |   |   |                      [<see def.>          ]<Default> No handler is used to modify the default one during initialization   #
#   |   |   |                      [list[api:<function>]]          Function to process the pulled data for each API                     #
#   |   |   |apiPkgPush        :   <str     > Name of the package from which to obtain the API function to push the data                #
#   |   |   |                      [NULL                ]<Default> Obtain the API from current session in global environment            #
#   |   |   |                      [<str>               ]          Package name valid for function <AdvOp$importByStr>                  #
#   |   |   |apiPfxPush        :   <str     > Prefix of the pusher API name to search                                                   #
#   |   |   |                      [std_write_          ]<Default> Search for the API names by this prefix                              #
#   |   |   |                      [<str>               ]          Set a proper prefix to validate the search                           #
#   |   |   |apiSfxPush        :   <str     > Suffix of the pusher API name to search                                                   #
#   |   |   |                      [<empty>             ]<Default> No specific suffix, be careful to use this setting                   #
#   |   |   |                      [<str>               ]          Set a proper suffix to validate the search                           #
#   |   |   |apiPushHdl        :   list[api:<function>] Dict of functions bound to APIs, each with only one argument as handler to      #
#   |   |   |                       process the data pulled at once                                                                     #
#   |   |   |                      [<see def.>          ]<Default> No handler is used to modify the default one during initialization   #
#   |   |   |                      [list[api:<function>]]          Function to process the pushed data for each API                     #
#   |   |   |argsPull          :   <list    > Collection of keyword arguments set as default for <pull> methods when instantiating the  #
#   |   |   |                       class; <key> is the available API name, <value> is the kwargs for its <pull> method                 #
#   |   |   |                      [<see def.>          ]<Default> Pull SAS datasets with encoding <GB18030> as maximum compatibility   #
#   |   |   |                      [<list>              ]          list[<apiname> : list[kw]]                                           #
#   |   |   |argsPush          :   <list    > Collection of keyword arguments set as default for <push> methods when instantiating the  #
#   |   |   |                       class; <key> is the available API name, <value> is the kwargs for its <push> method                 #
#   |   |   |                      [<see def.>          ]<Default> Push SAS datasets with encoding <GB2312> as maximum compatibility    #
#   |   |   |                      [<list>              ]          list[<apiname> : list[kw]]                                           #
#   |   |   |lsPullOpt         :   <list    > Options to list the <pull> functions given <apiPkgPull == NULL>                           #
#   |   |   |                      [<empty>             ]<Default> Use the default arguments during searching                           #
#   |   |   |                      [<list>              ]          See definition of <AdvOp$ls_frame>                                   #
#   |   |   |lsPushOpt         :   <list    > Options to list the <push> functions given <apiPkgPush == NULL>                           #
#   |   |   |                      [<empty>             ]<Default> Use the default arguments during searching                           #
#   |   |   |                      [<list>              ]          See definition of <AdvOp$ls_frame>                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   Only for initialization                                                                              #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[add]                                                                                                                          #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to register an API with all its available methods to pull or push the data                     #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |.attr             :   <str     > Name of the dedicated API to register, e.g. SAS, R or RAM                                 #
#   |   |   |apiPullHdl        :   <function> Function with only one argument as handler to process the data pulled at once             #
#   |   |   |                      [<see def.>          ]<Default> No handler is used to modify the default one during initialization   #
#   |   |   |                      [<function>          ]          Function to process the pulled data                                  #
#   |   |   |apiPushHdl        :   <function> Function with only one argument as handler to process the data pushed at once             #
#   |   |   |                      [<see def.>          ]<Default> No handler is used to modify the default one during initialization   #
#   |   |   |                      [<function>          ]          Function to process the pushed data                                  #
#   |   |   |argsPull          :   <list    > kwargs for the <pull> method of the registered API as default arguments at initilization  #
#   |   |   |argsPush          :   <list    > kwargs for the <push> method of the registered API as default arguments at initilization  #
#   |   |   |...               :   <list    > Additional keyword arguments. Not in use, but with compatibility of unified process       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method only creates and instantiates the dynamic class by registering the API                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[addfull]                                                                                                                      #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to register all available APIs found in the provided packages at once                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |apiPullHdl        :   list[api:<function>] Dict of functions bound to APIs, each with only one argument as handler to      #
#   |   |   |                       process the data pulled at once                                                                     #
#   |   |   |                      [<see def.>          ]<Default> No handler is used to modify the default one during initialization   #
#   |   |   |                      [list[api:<function>]]          Function to process the pulled data for each API                     #
#   |   |   |apiPushHdl        :   list[api:<function>] Dict of functions bound to APIs, each with only one argument as handler to      #
#   |   |   |                       process the data pulled at once                                                                     #
#   |   |   |                      [<see def.>          ]<Default> No handler is used to modify the default one during initialization   #
#   |   |   |                      [list[api:<function>]]          Function to process the pushed data for each API                     #
#   |   |   |argsPull          :   <list    > kwargs for the <pull> method diferred for all APIs as default arguments at initilization  #
#   |   |   |argsPush          :   <list    > kwargs for the <push> method diferred for all APIs as default arguments at initilization  #
#   |   |   |...               :   <list    > Additional keyword arguments. Not in use, but with compatibility of unified process       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method only creates and instantiates the dynamic class by registering the APIs                  #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[remove]                                                                                                                       #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to deactivate an API                                                                           #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |.attr             :   <str     > Name of the dedicated API to deactivate                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method only deactivates the API                                                                 #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[removefull]                                                                                                                   #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to deactivate all active APIs at once                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method only deactivates the APIs                                                                #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |400.   Private method                                                                                                              #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[.chkactive.]                                                                                                                  #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to abort the process if some dedicated methods are to operate on the results from an API which #
#   |   |   |   | is NOT registered as an active one in current environment                                                             #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method does not return any value, except that it aborts the process when necessary              #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[.rem_affix.]                                                                                                                  #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This method is intended to extract the API name from the entire string, a.k.a. the name of the <pull> or <push>        #
#   |   |   |   | method, that contains the prefix and suffix                                                                           #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |mthdname          :   <str   > Name of the method, from which to extract the API name                                      #
#   |   |   |pfx               :   <str   > Prefix of the method name to remove                                                         #
#   |   |   |                      [<empty>             ]<Default> No specific prefix, be careful to use this setting                   #
#   |   |   |sfx               :   <str   > Suffix of the method name to remove                                                         #
#   |   |   |                      [<empty>             ]<Default> No specific suffix, be careful to use this setting                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<str>             :   The extracted API name                                                                               #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |700.   Active-binding method                                                                                                       #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[apipull]                                                                                                                      #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve all the available <pull> methods regardless of API names                                  #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<None>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<chr>             :   Full set of available method names                                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[apipush]                                                                                                                      #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve all the available <push> methods regardless of API names                                  #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<None>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<chr>             :   Full set of available method names                                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[apifull]                                                                                                                      #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve all the available <push> and <push> methods regardless of API names                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<None>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<chr>             :   Full set of available method names                                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[apidyn]                                                                                                                       #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve all in-RAM <push> and <push> methods regardless of API names                              #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<None>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<chr>             :   Full set of available method names                                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[full]                                                                                                                         #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve all the available APIs by validating the existence of their available methods             #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<chr>             :   Full set of available APIs to <pull> or <push> data per request                                      #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[status]                                                                                                                       #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve the status of all available APIs, <True> means the API is activated and instantiated,     #
#   |   |   |   | <False> is otherwise                                                                                                  #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<list>            :   list[<API> : bool]                                                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |[active]                                                                                                                       #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |   |001.   Introduction.                                                                                                       #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |   |This property is to retrieve the set of all active (i.e. instantiated) APIs                                            #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |100.   Parameters.                                                                                                         #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<NULL>            :   This method does not take external argument input                                                    #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |900.   Return Values by position.                                                                                          #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |   |<chr>             :   Set of active APIs                                                                                   #
#   |   |   |---------------------------------------------------------------------------------------------------------------------------#
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#---------------------------------------------------------------------------------------------------------------------------------------#
#300.   Update log.                                                                                                                     #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   | Date |    20240217        | Version | 1.00        | Updater/Creator | Lu Robin Bin                                                #
#   |______|____________________|_________|_____________|_________________|_____________________________________________________________#
#   | Log  |Version 1.                                                                                                                  #
#   |______|____________________________________________________________________________________________________________________________#
#---------------------------------------------------------------------------------------------------------------------------------------#
#400.   User Manual.                                                                                                                    #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   |See the [Full Test Program] section                                                                                                #
#---------------------------------------------------------------------------------------------------------------------------------------#
#500.   Dependent Facilities.                                                                                                           #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   |100.   Dependent Modules                                                                                                           #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |   |magrittr, glue, R6                                                                                                             #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |300.   Dependent user-defined functions                                                                                            #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |   |AdvDB                                                                                                                          #
#   |   |   |OpenSourceApiMeta                                                                                                          #
#   |   |-------------------------------------------------------------------------------------------------------------------------------#
#   |   |AdvOp                                                                                                                          #
#   |   |   |isVEC                                                                                                                      #
#   |   |   |ls_frame                                                                                                                   #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |700.   Parent classes                                                                                                              #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#---------------------------------------------------------------------------------------------------------------------------------------#

#001. Append the list of required packages to the global environment
#Below expression is used for easy copy-paste from raw text strings instead of quoted ones.
lst_pkg <- deparse(substitute(c(
	magrittr, glue, R6
)))
#Quote: https://www.regular-expressions.info/posixbrackets.html?wlr=1
lst_pkg <- paste0(lst_pkg, collapse = '')
lst_pkg <- gsub('[[:space:]]', '', lst_pkg, perl = T)
lst_pkg <- gsub('^c\\((.+)\\)', '\\1', lst_pkg, perl = T)
lst_pkg <- unlist(strsplit(lst_pkg, ',', perl = T))
options( omniR.req.pkg = base::union(getOption('omniR.req.pkg'), lst_pkg) )

#We should use the pipe operands supported by below package
library(magrittr)
#We should use the big-bang operand [!!!] supported by below package
library(rlang)

#[ASSUMPTION]
#[1] We use a verbose mode to create the class, just for storing the <class> itself to its instances
#Below link demonstrates why we use <local> to create the class
#Quote: https://github.com/r-lib/R6/issues/144
DataIO <- local({
mycls <- R6::R6Class(
	classname = 'DataIO'
	,public = list(
		#002. Constructor
		initialize = function(
			apiPkgPull = NULL
			,apiPfxPull = 'std_read_'
			,apiSfxPull = ''
			,apiPullHdl = list()
			,apiPkgPush = NULL
			,apiPfxPush = 'std_write_'
			,apiSfxPush = ''
			,apiPushHdl = list()
			,argsPull = list(
				'SAS' = list(
					'encoding' = 'GB2312'
				)
			)
			,argsPush = list(
				'SAS' = list(
					'encoding' = 'GB2312'
				)
			)
			,lsPullOpt = list()
			,lsPushOpt = list()
		) {
			#100. Assign values to local variables
			self$..class.. <- mycls
			self$apiPkgPull <- apiPkgPull
			self$apiPfxPull <- apiPfxPull
			self$apiSfxPull <- apiSfxPull
			self$apiPkgPush <- apiPkgPush
			self$apiPfxPush <- apiPfxPush
			self$apiSfxPush <- apiSfxPush
			self$argsPull <- argsPull
			self$argsPush <- argsPush
			self$lsPullOpt <- lsPullOpt
			self$lsPushOpt <- lsPushOpt

			#200. Determine the scope from which to search for the functions
			#[ASSUMPTION]
			#[1] <nchar(NULL)> returns <logical(0)> instead of <0>
			#[2] That is why we have to verify it at another step
			self$hasPkgPull <- isVEC(self$apiPkgPull) & is.character(self$apiPkgPull) & (length(self$apiPkgPull) == 1)
			if (self$hasPkgPull) {
				if (nchar(self$apiPkgPull) == 0) self$hasPkgPull <- F
			}

			self$hasPkgPush <- isVEC(self$apiPkgPush) & is.character(self$apiPkgPush) & (length(self$apiPkgPush) == 1)
			if (self$hasPkgPush) {
				if (nchar(self$apiPkgPush) == 0) self$hasPkgPush <- F
			}

			#300. Search for available APIs
			this_full <- self$full
			private$..vec_active.. <- sapply(this_full, function(x) F, simplify = T, USE.NAMES = T)

			#700. Initialize the handlers
			hdl_pull <- sapply(
				this_full
				,function(x) {
					f <- apiPullHdl[[x]]
					if (is.function(f)) {
						return(f)
					} else {
						return(function(x) x)
					}
				}
				,simplify = F
				,USE.NAMES = T
			)
			hdl_push <- sapply(
				this_full
				,function(x) {
					f <- apiPushHdl[[x]]
					if (is.function(f)) {
						return(f)
					} else {
						return(function(x) x)
					}
				}
				,simplify = F
				,USE.NAMES = T
			)
			self$apiPullHdl <- hdl_pull
			self$apiPushHdl <- hdl_push
		}
		#005. Declaration of public attributes
		,apiPkgPull = NULL
		,apiPfxPull = NULL
		,apiSfxPull = NULL
		,apiPkgPush = NULL
		,apiPfxPush = NULL
		,apiSfxPush = NULL
		,apiPullHdl = NULL
		,apiPushHdl = NULL
		,argsPull = NULL
		,argsPush = NULL
		,lsPullOpt = NULL
		,lsPushOpt = NULL
		,hasPkgPull = NULL
		,hasPkgPush = NULL
		,..class.. = NULL
		#300. Public methods
		#310. Add an API by its name
		#[ASSUMPTION]
		#[1] We do not pull data from the newly created API, since the dots <...> cannot be determined for which
		#     of the available APIs, esp. when calling <self$addfull()>
		,add = function(
			.attr
			,apiPullHdl = NULL
			,apiPushHdl = NULL
			,argsPull = list()
			,argsPush = list()
			,...
		) {
			#001. Verify whether the API can be found in the candidate packages
			if (!.attr %in% self$full) {
				stop(glue::glue('[{self$..class..$classname}]No method is found to register API for [{.attr}]!'))
			}

			#100. Tweak the handlers if provided
			if (is.function(apiPullHdl)) {
				hdl_pull <- apiPullHdl
			} else {
				hdl_pull <- self$apiPullHdl[[.attr]]
			}
			if (is.function(apiPushHdl)) {
				hdl_push <- apiPushHdl
			} else {
				hdl_push <- self$apiPushHdl[[.attr]]
			}

			#200. Create API class on the fly
			cls <- OpenSourceApiMeta(
				classname = .attr
				,apiPkgPull = self$apiPkgPull
				,apiPfxPull = self$apiPfxPull
				,apiSfxPull = self$apiSfxPull
				,apiPullHdl = hdl_pull
				,lsPullOpt = self$lsPullOpt
				,apiPkgPush = self$apiPkgPush
				,apiPfxPush = self$apiPfxPush
				,apiSfxPush = self$apiSfxPush
				,apiPushHdl = hdl_push
				,lsPushOpt = self$lsPushOpt
			)

			#200. Prepare keyword arguments for reading data from the API
			#[ASSUMPTION]
			#[1] We take the default keyword arguments in current API as top priority,
			#     given neither <self$argsPull> nor <argsPull> is provided
			#[2] Given <self$argsPull> is non-empty while <argsPull> is empty, we take <self$argsPull> to call the API
			#[3] Given <argsPull> is provided, we call the API with it
			kw_pull_init <- self$argsPull[[.attr]]
			if (is.null(kw_pull_init)) kw_pull_init <- list()
			kw_pull <- modifyList(kw_pull_init, argsPull, keep.null = T)
			kw_push_init <- self$argsPush[[.attr]]
			if (is.null(kw_push_init)) kw_push_init <- list()
			kw_push <- modifyList(kw_push_init, argsPush, keep.null = T)

			#500. Instantiate the API
			obj <- cls$new(argsPull = kw_pull, argsPush = kw_push, ...)

			#700. Add current API to the attribute list of current framework
			#Quote: https://coolbutuseless.github.io/2021/02/19/modifying-r6-objects-after-creation/
			self[[.attr]] <- obj
			environment(self[[.attr]]) <- self$.__enclos_env__

			#900. Modify private environment
			private$..vec_active..[[.attr]] <- T
			invisible()
		}
		#320. Add all available APIs to current private environment
		,addfull = function(
			apiPullHdl = list()
			,apiPushHdl = list()
			,argsPull = list()
			,argsPush = list()
			,...
		) {
			for (a in self$full) {
				kw_pull <- argsPull[[a]]
				if (is.null(kw_pull)) kw_pull <- list()
				kw_push <- argsPush[[a]]
				if (is.null(kw_push)) kw_push <- list()
				self$add(
					a
					,apiPullHdl = apiPullHdl[[a]]
					,apiPushHdl = apiPushHdl[[a]]
					,argsPull = kw_pull
					,argsPush = kw_push
					,...
				)
			}
			invisible()
		}
		#360. Remove API from private environment
		,remove = function(.attr) {
			attr_exist <- ls(self$.__enclos_env__$self, all.names = T, pattern = glue::glue('^{.attr}$'))
			if (length(attr_exist) > 0) rm(list = .attr, pos = self$.__enclos_env__$self)
			private$..vec_active..[[.attr]] <- F
			invisible()
		}
		#370. Remove all active APIs from private environment
		,removefull = function() {
			lapply(self$full, self$remove)
			invisible()
		}
	)
	,private = list(
		..vec_active.. = NULL
		#410. Verify whether there is at least 1 active API in the private environment
		,.chkactive. = function(funcname) {
			if (length(self$active) == 0) {
				stop(glue::glue('[{self$..class..$classname}][{funcname}] is empty as there is no active API!'))
			}
		}
		#430. Remove the affixes from the API names
		,.rem_affix. = function(mthdname, pfx = '', sfx = '') {
			gsub(glue::glue('^{pfx}(.+){sfx}$'), '\\1', mthdname, fixed = F, perl = T)
		}
	)
	#500. Read-only properties
	,active = list(
		#510. Obtain the available <pull> methods
		apipull = function() {
			#100. Local parameters
			candopt_rx <- list(
				'verbose' = FALSE
				,'predicate' = is.function
				,'ignore_case' = FALSE
				,'multiline' = FALSE
				,'comments' = FALSE
				,'dotall' = FALSE
			)

			#300. Prepare the pattern for searching
			#[ASSUMPTION]
			#[1] We would call external function <glue::glue> for some conditions
			#[2] Hence the variables are lazy-evaluated
			#[3] Even if we add <.envir=> option to bind the call to current environment, it still fails
			#[4] Therefore, we set the pattern by text manipulation before any external function call
			apiPtnPull <- paste0('^',self$apiPfxPull,'.+',self$apiSfxPull,'$')

			#500. Differ the process
			if (self$hasPkgPull) {
				api_pull <- ls(
					loadNamespace(self$apiPkgPull)
					,all.names = T
					,pattern = apiPtnPull
				) %>%
					sapply(function(x){is.function(get(x, envir = loadNamespace(self$apiPkgPull)))}) %>%
					{Filter(isTRUE, .)} %>%
					names()
			} else {
				lsPullOpt <- c(
					candopt_rx
					,self$lsPullOpt[!names(self$lsPullOpt) %in% c(names(candopt_rx),'pattern')]
				)
				api_pull <- do.call(
					ls_frame
					,c(
						list(pattern = apiPtnPull)
						,lsPullOpt
					)
				)
			}

			#900. Output
			return(api_pull)
		}
		#520. Obtain the available <push> methods
		,apipush = function() {
			#100. Local parameters
			candopt_rx <- list(
				'verbose' = FALSE
				,'predicate' = is.function
				,'ignore_case' = FALSE
				,'multiline' = FALSE
				,'comments' = FALSE
				,'dotall' = FALSE
			)

			#300. Prepare the pattern for searching
			apiPtnPush <- paste0('^',self$apiPfxPush,'.+',self$apiSfxPush,'$')

			#500. Differ the process
			if (self$hasPkgPush) {
				api_push <- ls(
					loadNamespace(self$apiPkgPush)
					,all.names = T
					,pattern = apiPtnPush
				) %>%
					sapply(function(x){is.function(get(x, envir = loadNamespace(self$apiPkgPush)))}) %>%
					{Filter(isTRUE, .)} %>%
					names()
			} else {
				lsPushOpt <- c(
					candopt_rx
					,self$lsPushOpt[!names(self$lsPushOpt) %in% c(names(candopt_rx),'pattern')]
				)
				api_push <- do.call(
					ls_frame
					,c(
						list(pattern = apiPtnPush)
						,lsPushOpt
					)
				)
			}

			#900. Output
			return(api_push)
		}
		#530. Obtain all methods for APIs
		,apifull = function() {
			return(base::union(self$apipull,self$apipush))
		}
		#535. Obtain dynamic methods for APIs, i.e. the methods created in current session
		,apidyn = function() {
			if (self$hasPkgPull) {
				apipull <- NULL
			} else {
				apipull <- self$apipull
			}
			if (self$hasPkgPush) {
				apipush <- NULL
			} else {
				apipush <- self$apipush
			}
			return(base::union(apipull,apipush))
		}
		#540. Obtain the full set of available APIs
		,full = function() {
			#500. Extract API name from the methods
			apipull <- private$.rem_affix.(self$apipull, pfx = self$apiPfxPull, sfx = self$apiSfxPull)
			apipush <- private$.rem_affix.(self$apipush, pfx = self$apiPfxPush, sfx = self$apiSfxPush)

			#999. Return if there is either a <pull> method or <push> for the API
			return(base::union(apipull,apipush))
		}
		#570. Obtain the status of all APIs
		,status = function() {
			return(private$..vec_active..)
		}
		#580. Obtain the names of active APIs
		,active = function() {
			return(names(Filter(isTRUE, private$..vec_active..)))
		}
	)
	#[ASSUMPTION]
	#[1] We have to unlock the instantiated object for member manipulation
	#[2] Unlike Python, there is no <__slots__> for R, hence this operation is dangerous
	,lock_objects = F
)

return(mycls)
})

#[Full Test Program;]
if (FALSE){
	#Simple test
	if (TRUE){
		#010. Load user defined functions
		dir_omniR <- 'D:\\R'
		source(file.path(dir_omniR, 'autoexec.r'))

		#We should use the big-bang operand [!!!] supported by below package
		library(rlang)

		#100. Launch the tool with default arguments
		cwd <- getwd()
		dataIO <- DataIO$new()

		#200. List all available APIs at present
		dataIO$full
		# [1] "R"   "RAM" "SAS"

		#300. Convert data using SAS API
		smpl_sas <- file.path(dir_omniR, 'omniR', 'AdvDB', 'test_loadsasdat.sas7bdat')
		api <- 'SAS'
		dataIO$add(api)

		#310. Load data
		sas_pulled <- dataIO[[api]]$pull(smpl_sas)
		# tibble [200 x 6] (S3: tbl_df/tbl/data.frame)

		#330. Redirect the pulled data
		sas_pulled2 <- dataIO[[api]]$pulled
		# tibble [200 x 6] (S3: tbl_df/tbl/data.frame)

		#350. Write the data from RAM to the requested path
		#355. Modify the inference of the output config
		meta_sas <- inferContents(sas_pulled) %>%
			dplyr::mutate(
				!!rlang::sym('FORMATD') := ifelse(!!rlang::sym('NAME') == 'f_qpv', 0, !!rlang::sym('FORMATD'))
			)

		#359. Push the data to the destination using the modified meta config table
		#[ASSUMPTION]
		#[1] 'test' is a placeholder for this API, just for unification purpose
		outf1 <- file.path(cwd, 'vfysas1.sas7bdat')
		rc <- dataIO[[api]]$push(list('test' = sas_pulled), outfile = outf1, metaVar = meta_sas)
		if (file.exists(outf1)) rc <- file.remove(outf1)
		dataIO$remove(api)

		#500. Convert data using RData API
		smpl_R <- list(
			'key1' = data.frame(aa = c(1,3,5), bb = c('c','d','e'))
			,'key2' = data.frame(aa = c(5,4,8), bb = c('f','g','h'))
		)
		outf2 <- file.path(cwd, 'vfyRData1.RData')
		api2 <- 'R'
		dataIO$add(api2)

		#510. Write the data from RAM to the requested path
		#[ASSUMPTION]
		#[1] RData can store multiple objects in the same batch
		rc <- dataIO[[api2]]$push(smpl_R, outfile = outf2)

		#530. Load data from above storage
		#[ASSUMPTION]
		#[1] As a unified process, the <pull> method can only pull one object from the API
		R_pulled <- dataIO[[api2]]$pull(outf2, key = 'key2')
		#   aa bb
		# 1  5  f
		# 2  4  g
		# 3  8  h

		#560. Change the handler of <pull> method for the API
		#561. Prepare the function to remove the required column from the data frame
		h_remcol <- function(x){x %>% dplyr::select(-tidyselect::any_of(c('bb','kk')))}

		#563. Modify the handler
		#[ASSUMPTION]
		#[1] High order functions such as <purrr::partial> will prevent the internal environment binding of the masked function
		#[2] That is why we cannot assign new methods in the commented way
		# dataIO[[api2]]$hdlPull <- purrr::partial(h_remcol, col = c('bb','kk'))
		dataIO[[api2]]$hdlPull <- h_remcol

		#570. Load data with the updated handler
		R_chk <- dataIO[[api2]]$pull(outf2, key = 'key1')
		#   aa
		# 1  1
		# 2  3
		# 3  5

		#599. Purge
		if (file.exists(outf2)) rc <- file.remove(outf2)

		#700. Operate in RAM
		dat_before <- data.frame(a = c(2,5,9))
		api3 <- 'RAM'
		dataIO$add(api3)

		#710. Read data from RAM by its name and mutate it
		h_conv <- function(df) {
			df %>% dplyr::mutate('b' = c(5,4,1))
		}
		ram_redir <- dataIO[[api3]]$pull('dat_before', funcConv = h_conv)
		#   a b
		# 1 2 5
		# 2 5 4
		# 3 9 1

		#750. Push the data to another address within RAM
		#[ASSUMPTION]
		#[1] Same as SAS, 'dummy' is a placeholder for this API, just for unification purpose
		rc <- dataIO[[api3]]$push(list('dummy' = ram_redir), outfile = 'ram_new')

		#770. Retrieve the exported data frame
		ram_visible <- get_values('ram_new', mode = 'list')
		#   a b
		# 1 2 5
		# 2 5 4
		# 3 9 1

		#790. Try to add an API that does not exist in vain
		dataIO$add('pseudo')
		# [DataIO]No method is found to register API for [pseudo]!

		#800. Create the instance by searching within the scope of a function
		testIO <- function(){
			frame <- environment()
			std_read_SAS <- function(){print('local')}
			std_write_HDFS <- function(){print('local')}
			dataIO3 <- DataIO$new(
				lsPullOpt = list('frame' = frame)
				,lsPushOpt = list('frame' = frame)
			)
			print(dataIO3$full)

			#Check whether the API is from local scope
			dataIO3$add('SAS')
			rc <- dataIO3[['SAS']]$pull()

			#Ensure there is no unexpected return value
			invisible()
		}
		testIO()
		# [1] "SAS"  "HDFS"
		# [1] "local"

	}
}
