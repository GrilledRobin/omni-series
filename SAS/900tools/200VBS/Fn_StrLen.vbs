' VBScript sample using Windows Script Host
'Set WshShell = WScript.CreateObject("WScript.Shell")
'WshShell.Popup "Hello World!"
'*000.	Info.;
'*-------------------------------------------------------------------------------------------------------------------------------------*'
'100.	Introduction.																													'
'---------------------------------------------------------------------------------------------------------------------------------------'
'	|This script is to define a function to determine the length in bytes (rather than in Characters) of a string						'
'---------------------------------------------------------------------------------------------------------------------------------------'
'200.	Glossary.																														'
'---------------------------------------------------------------------------------------------------------------------------------------'
'	|str		:	The character string to be identified the length in bytes															'
'	|Returns	:	The length in bytes																									'
'---------------------------------------------------------------------------------------------------------------------------------------'
'300.	Update log.																														'
'---------------------------------------------------------------------------------------------------------------------------------------'
'	| Date |	2017-09-09		| Version |	1.00		| Updater/Creator |	Robin Lu Bin												'
'	|______|____________________|_________|_____________|_________________|_____________________________________________________________'
'	| Log  |Version 1.																													'
'	|______|____________________________________________________________________________________________________________________________'
'---------------------------------------------------------------------------------------------------------------------------------------'
'400.	User Manual.																													'
'---------------------------------------------------------------------------------------------------------------------------------------'
'	|[1] Call this script to define the public fuction																					'
'	|[2] Provide the [Character String] while calling this function during your own script												'
'	|[3] Use the length it returns anywhere you need																					'
'---------------------------------------------------------------------------------------------------------------------------------------'
'500.	Dependent Scripts.																												'
'---------------------------------------------------------------------------------------------------------------------------------------'
'*-------------------------------------------------------------------------------------------------------------------------------------*'

Public Function StrLen(str)
dim cnt
cnt=0
StrLen=0
cnt=len(str)

For i=1 to cnt
	If (asc(mid(str,i,1)) < 0 or asc(mid(str,i,1)) > 127) then
		StrLen=int(StrLen) + 2
	Else
		StrLen=int(StrLen) + 1
	End If
Next
End Function

'* Examples Begin ---------------------------------------------------------------------------------------------------------------------*'
'100.	Direct call of the function.																									'
'	myStr = "ол╣Щ"																														'
'	'In this case, the normal LEN function returns [2], while below function returns [4]												'
'	myLen = StrLen( myStr )																												'
'	WScript.Echo "Character length is: " & myLen																						'
'* Examples End   ---------------------------------------------------------------------------------------------------------------------*'