%macro VBS_CrFn_StrLen(
	VBSFile	=
);
%*000.	Info.;
/*-------------------------------------------------------------------------------------------------------------------------------------*\
|100.	Introduction.																													|
|---------------------------------------------------------------------------------------------------------------------------------------|
|---------------------------------------------------------------------------------------------------------------------------------------|
|200.	Glossary.																														|
|---------------------------------------------------------------------------------------------------------------------------------------|
|	|VBSFile	:	The VBS file defining public functions.																				|
|---------------------------------------------------------------------------------------------------------------------------------------|
|300.	Update log.																														|
|---------------------------------------------------------------------------------------------------------------------------------------|
|	| Date |	20140915		| Version |	1.00		| Updater/Creator |	Lu Robin Bin												|
|	|______|____________________|_________|_____________|_________________|_____________________________________________________________|
|	| Log  |Version 1.																													|
|	|______|____________________________________________________________________________________________________________________________|
|---------------------------------------------------------------------------------------------------------------------------------------|
|400.	User Manual.																													|
|---------------------------------------------------------------------------------------------------------------------------------------|
|	|This function ALMOST resembles the same one as in VB or VBA																		|
|---------------------------------------------------------------------------------------------------------------------------------------|
|500.	Dependent Macros.																												|
|---------------------------------------------------------------------------------------------------------------------------------------|
\*-------------------------------------------------------------------------------------------------------------------------------------*/

%*010.	Set parameters.;
%local
	L_mcrLABEL
;
%let	L_mcrLABEL	=	&sysMacroName.;

%*100.	Generate VB Script.;
data _NULL_;
	file "&VBSFile.";

	put	"Public Function StrLen(str)";
	put	"    dim cnt";
	put	"    cnt=0";
	put	"    StrLen=0";
	put	"    cnt=len(str)";
	put	"    For i=1 to cnt";
	put	"        If (asc(mid(str,i,1)) < 0 or asc(mid(str,i,1)) > 127) then";
	put	"            StrLen=int(StrLen) + 2";
	put	"        Else";
	put	"            StrLen=int(StrLen) + 1";
	put	"        End If";
	put	"     Next";
	put	"End Function";
run;

%EndOfProc:
%mend VBS_CrFn_StrLen;