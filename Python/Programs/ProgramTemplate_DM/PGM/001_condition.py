#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#---------------------------------------------------------------------------------------------------------------------------------------#
#100.   Introduction.                                                                                                                   #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   |This is to demonstrate how to run the Data Mart Management process on each workday                                                 #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |ASSUMPTION                                                                                                                         #
#   |-----------------------------------------------------------------------------------------------------------------------------------#
#   |[1] In order to honor the public holiday adjustments in any country, you need to place <CalendarAdj.csv> in the same folder as the #
#   |     module <omniPy.Dates>; see <omniPy.Dates.getCalendarAdj>                                                                      #
#---------------------------------------------------------------------------------------------------------------------------------------#
#300.   Update log.                                                                                                                     #
#---------------------------------------------------------------------------------------------------------------------------------------#
#   | Date |    20250404        | Version | 1.00        | Updater/Creator | Lu Robin Bin                                                #
#   |______|____________________|_________|_____________|_________________|_____________________________________________________________#
#   | Log  |Version 1.                                                                                                                  #
#   |______|____________________________________________________________________________________________________________________________#
#   |___________________________________________________________________________________________________________________________________#
#   | Date |    20250404        | Version | 1.10        | Updater/Creator | Lu Robin Bin                                                #
#   |______|____________________|_________|_____________|_________________|_____________________________________________________________#
#   | Log  |[1] Demo of update log 1                                                                                                    #
#   |      |[2] Demo of update log 2                                                                                                    #
#   |______|____________________________________________________________________________________________________________________________#
#---------------------------------------------------------------------------------------------------------------------------------------#

print('Determine whether to run all subsequent scripts')
import sys
from omniPy.Dates import intnx

if L_curdate != intnx('day', L_curdate, 0, 'e', daytype = 'w').strftime('%Y%m%d'):
    print(f'Current data date <{L_curdate}> is not workday, skip the process.')
    sys.exit()
